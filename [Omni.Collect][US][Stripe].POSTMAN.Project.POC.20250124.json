{
	"info": {
		"_postman_id": "9fa9d367-8000-4327-82a1-067d83cf5094",
		"name": "Stripe API POC 20250124",
		"description": "This Postman collection demonstrates:\n1. Stripe Checkout flows (Normal, Pre-Authorization, Subscription) with the requested fixes:\n   - Remove product_data[description] at 1.1.1.\n   - Use payment_intent_data[capture_method]=manual at 1.2.2.\n2. Stripe Elements flows (Normal, Pre-Auth, Subscription).\n3. Common endpoints (Retrieve Payment Intent, Refund, etc.).",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "12409896"
	},
	"item": [
		{
			"name": "0. Common Setup & Webhook",
			"item": [
				{
					"name": "Step 0.1 - Create Webhook Endpoint",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"let response = pm.response.json();",
									"",
									"if (response.id) {",
									"    pm.collectionVariables.set(\"webhook_endpoint_id\", response.id);",
									"    console.log(\"Created webhook endpoint:\", response.id);",
									"} else {",
									"    console.warn(\"No webhook endpoint ID returned.\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{stripe_secret_key}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "url",
									"value": "{{webhook_url}}",
									"type": "text"
								},
								{
									"key": "enabled_events[]",
									"value": "checkout.session.completed",
									"type": "text"
								},
								{
									"key": "enabled_events[]",
									"value": "payment_intent.succeeded",
									"type": "text"
								},
								{
									"key": "enabled_events[]",
									"value": "payment_intent.payment_failed",
									"type": "text"
								},
								{
									"key": "enabled_events[]",
									"value": "invoice.paid",
									"type": "text"
								},
								{
									"key": "enabled_events[]",
									"value": "invoice.payment_failed",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{stripe_base_url}}/v1/webhook_endpoints",
							"host": [
								"{{stripe_base_url}}"
							],
							"path": [
								"v1",
								"webhook_endpoints"
							]
						},
						"description": "Creates a webhook endpoint for receiving checkout.session.completed, payment_intent.*, invoice.* events."
					},
					"response": []
				}
			]
		},
		{
			"name": "1. Stripe Checkout",
			"item": [
				{
					"name": "1.1 - Normal Single Payment",
					"item": [
						{
							"name": "Step 1.1.1 - Create Random Price (One-time) [Fix: No 'product_data[description]']",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"// Generate random product name",
											"const randomName = \"checkout-prod-\" + Math.random().toString(36).substring(2, 8);",
											"// Generate random price (10.00 - 99.99 USD)",
											"const randomAmount = Math.floor(Math.random() * 9000) + 1000;",
											"pm.collectionVariables.set(\"random_name\", randomName);",
											"pm.collectionVariables.set(\"random_amount\", randomAmount.toString());",
											"console.log(\"Random Checkout Product:\", randomName, \" Amount:\", randomAmount);"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"let jsonData = pm.response.json();",
											"if (jsonData.id) {",
											"    pm.collectionVariables.set(\"price_id_checkout_single\", jsonData.id);",
											"    console.log(\"Checkout Single Price ID:\", jsonData.id);",
											"} else {",
											"    console.error(\"No Price ID returned.\");",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "unit_amount",
											"value": "{{random_amount}}",
											"type": "text"
										},
										{
											"key": "currency",
											"value": "usd",
											"type": "text"
										},
										{
											"key": "product_data[name]",
											"value": "{{random_name}}",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{stripe_base_url}}/v1/prices",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"prices"
									]
								},
								"description": "Creates a one-time Price for normal single payment in Stripe Checkout."
							},
							"response": []
						},
						{
							"name": "Step 1.1.2 - Create Checkout Session (Normal Single Payment)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"let jsonData = pm.response.json();",
											"if(jsonData.id) {",
											"    pm.collectionVariables.set(\"checkout_session_id_normal\", jsonData.id);",
											"}",
											"if(jsonData.url) {",
											"    console.log(\"Checkout Session URL:\", jsonData.url);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "success_url",
											"value": "{{success_url}}",
											"type": "text"
										},
										{
											"key": "cancel_url",
											"value": "{{cancel_url}}",
											"type": "text"
										},
										{
											"key": "line_items[0][price]",
											"value": "{{price_id_checkout_single}}",
											"type": "text"
										},
										{
											"key": "line_items[0][quantity]",
											"value": "1",
											"type": "text"
										},
										{
											"key": "mode",
											"value": "payment",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{stripe_base_url}}/v1/checkout/sessions",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"checkout",
										"sessions"
									]
								},
								"description": "Creates a Stripe Checkout Session for a normal single payment (auto-capture)."
							},
							"response": []
						}
					]
				},
				{
					"name": "1.2 - Pre-Authorization (Manual Capture)",
					"item": [
						{
							"name": "Step 1.2.1 - Create Random Price (Manual Capture scenario)",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"// Generate random product name",
											"const randomName = \"checkout-preauth-\" + Math.random().toString(36).substring(2, 8);",
											"// Generate random price (10.00 - 99.99 USD)",
											"const randomAmount = Math.floor(Math.random() * 9000) + 1000;",
											"pm.collectionVariables.set(\"random_name\", randomName);",
											"pm.collectionVariables.set(\"random_amount\", randomAmount.toString());",
											"console.log(\"Random PreAuth Product:\", randomName, \" Amount:\", randomAmount);"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"let jsonData = pm.response.json();",
											"if (jsonData.id) {",
											"    pm.collectionVariables.set(\"price_id_checkout_preauth\", jsonData.id);",
											"    console.log(\"Checkout PreAuth Price ID:\", jsonData.id);",
											"} else {",
											"    console.error(\"No Price ID returned.\");",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "unit_amount",
											"value": "{{random_amount}}",
											"type": "text"
										},
										{
											"key": "currency",
											"value": "usd",
											"type": "text"
										},
										{
											"key": "product_data[name]",
											"value": "{{random_name}}",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{stripe_base_url}}/v1/prices",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"prices"
									]
								},
								"description": "Creates a one-time Price for the pre-authorization (manual capture) scenario."
							},
							"response": []
						},
						{
							"name": "Step 1.2.2 - Create Checkout Session (payment_intent_data[capture_method]=manual)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"let jsonData = pm.response.json();",
											"if(jsonData.id) {",
											"    pm.collectionVariables.set(\"checkout_session_id_preauth\", jsonData.id);",
											"}",
											"if(jsonData.url) {",
											"    console.log(\"Checkout PreAuth URL:\", jsonData.url);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "mode",
											"value": "payment",
											"type": "text"
										},
										{
											"key": "payment_intent_data[capture_method]",
											"value": "manual",
											"type": "text"
										},
										{
											"key": "payment_intent_data[description]",
											"value": "Pre-auth via Checkout",
											"type": "text"
										},
										{
											"key": "line_items[0][price]",
											"value": "{{price_id_checkout_preauth}}",
											"type": "text"
										},
										{
											"key": "line_items[0][quantity]",
											"value": "1",
											"type": "text"
										},
										{
											"key": "success_url",
											"value": "{{success_url}}",
											"type": "text"
										},
										{
											"key": "cancel_url",
											"value": "{{cancel_url}}",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{stripe_base_url}}/v1/checkout/sessions",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"checkout",
										"sessions"
									]
								},
								"description": "Checkout Session that creates a Payment Intent with manual capture. Funds authorized, not captured automatically."
							},
							"response": []
						},
						{
							"name": "Step 1.2.3 - Retrieve Checkout Session & Store PaymentIntent",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"let data = pm.response.json();",
											"if(data.payment_intent){",
											"   pm.collectionVariables.set(\"pi_checkout_preauth_id\", data.payment_intent);",
											"   console.log(\"Payment Intent for PreAuth:\", data.payment_intent);",
											"} else {",
											"   console.warn(\"No payment_intent in session.\");",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{stripe_base_url}}/v1/checkout/sessions/{{checkout_session_id_preauth}}",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"checkout",
										"sessions",
										"{{checkout_session_id_preauth}}"
									]
								},
								"description": "Retrieve the Checkout Session to see which Payment Intent was created."
							},
							"response": []
						},
						{
							"name": "Step 1.2.4 - Capture the Payment Intent (Manual)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{stripe_base_url}}/v1/payment_intents/{{pi_checkout_preauth_id}}/capture",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"payment_intents",
										"{{pi_checkout_preauth_id}}",
										"capture"
									]
								},
								"description": "Captures the Payment Intent that was authorized via Checkout with manual capture."
							},
							"response": []
						}
					]
				},
				{
					"name": "1.3 - Subscription (Recurring Payment)",
					"item": [
						{
							"name": "Step 1.3.1 - Create Recurring Price for Checkout",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"let jsonData = pm.response.json();",
											"if(jsonData.id) {",
											"    pm.collectionVariables.set(\"price_id_checkout_sub\", jsonData.id);",
											"    console.log(\"Recurring Price ID (Checkout):\", jsonData.id);",
											"} else {",
											"    console.error(\"No recurring Price ID returned.\");",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "currency",
											"value": "usd",
											"type": "text"
										},
										{
											"key": "recurring[interval]",
											"value": "month",
											"type": "text"
										},
										{
											"key": "unit_amount",
											"value": "999",
											"type": "text"
										},
										{
											"key": "product_data[name]",
											"value": "Checkout Sub Product",
											"type": "text"
										},
										{
											"key": "nickname",
											"value": "Monthly Recurring (Checkout)",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{stripe_base_url}}/v1/prices",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"prices"
									]
								},
								"description": "Creates a monthly recurring Price (e.g. $9.99) for subscription via Stripe Checkout."
							},
							"response": []
						},
						{
							"name": "Step 1.3.2 - Create Checkout Session (Subscription)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"let jsonData = pm.response.json();",
											"if(jsonData.id) {",
											"    pm.collectionVariables.set(\"checkout_session_id_sub\", jsonData.id);",
											"}",
											"if(jsonData.url) {",
											"    console.log(\"Checkout Subscription URL:\", jsonData.url);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "success_url",
											"value": "{{success_url}}",
											"type": "text"
										},
										{
											"key": "cancel_url",
											"value": "{{cancel_url}}",
											"type": "text"
										},
										{
											"key": "line_items[0][price]",
											"value": "{{price_id_checkout_sub}}",
											"type": "text"
										},
										{
											"key": "line_items[0][quantity]",
											"value": "1",
											"type": "text"
										},
										{
											"key": "mode",
											"value": "subscription",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{stripe_base_url}}/v1/checkout/sessions",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"checkout",
										"sessions"
									]
								},
								"description": "Creates a Checkout Session for a subscription. After payment, Stripe creates a Subscription object."
							},
							"response": []
						}
					]
				}
			]
		},
		{
			"name": "2. Stripe Elements",
			"item": [
				{
					"name": "2.1 - Normal Single Payment (Simulated Card Data)",
					"item": [
						{
							"name": "Step 2.1.1 - Create Payment Intent (auto capture)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "amount",
											"value": "2000",
											"type": "text"
										},
										{
											"key": "currency",
											"value": "usd",
											"type": "text"
										},
										{
											"key": "payment_method_data[type]",
											"value": "card",
											"type": "text"
										},
										{
											"key": "payment_method_data[card][number]",
											"value": "4242424242424242",
											"type": "text"
										},
										{
											"key": "payment_method_data[card][exp_month]",
											"value": "12",
											"type": "text"
										},
										{
											"key": "payment_method_data[card][exp_year]",
											"value": "2030",
											"type": "text"
										},
										{
											"key": "payment_method_data[card][cvc]",
											"value": "123",
											"type": "text"
										},
										{
											"key": "confirm",
											"value": "true",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{stripe_base_url}}/v1/payment_intents",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"payment_intents"
									]
								},
								"description": "Simulating a Stripe Elements flow by providing card data directly. This automatically confirms and captures the payment."
							},
							"response": []
						}
					]
				},
				{
					"name": "2.2 - Pre-Authorization (Manual Capture)",
					"item": [
						{
							"name": "Step 2.2.1 - Create Payment Intent (manual capture) + Confirm w/ Card",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "amount",
											"value": "4500",
											"type": "text"
										},
										{
											"key": "currency",
											"value": "usd",
											"type": "text"
										},
										{
											"key": "capture_method",
											"value": "manual",
											"type": "text"
										},
										{
											"key": "payment_method_data[type]",
											"value": "card",
											"type": "text"
										},
										{
											"key": "payment_method_data[card][number]",
											"value": "4242424242424242",
											"type": "text"
										},
										{
											"key": "payment_method_data[card][exp_month]",
											"value": "12",
											"type": "text"
										},
										{
											"key": "payment_method_data[card][exp_year]",
											"value": "2030",
											"type": "text"
										},
										{
											"key": "payment_method_data[card][cvc]",
											"value": "123",
											"type": "text"
										},
										{
											"key": "confirm",
											"value": "true",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{stripe_base_url}}/v1/payment_intents",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"payment_intents"
									]
								},
								"description": "Creates a Payment Intent with manual capture, simulating an Elements flow (card details). Authorizes but does not capture."
							},
							"response": []
						},
						{
							"name": "Step 2.2.2 - Capture the Payment Intent (manual)",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"// You can store the Payment Intent ID from step 2.2.1 in 'last_created_pi_id' in the Tests tab if needed."
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{stripe_base_url}}/v1/payment_intents/{{last_created_pi_id}}/capture",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"payment_intents",
										"{{last_created_pi_id}}",
										"capture"
									]
								},
								"description": "Captures the last Payment Intent created in step 2.2.1. You must store the ID in 'last_created_pi_id' via a Test script."
							},
							"response": []
						}
					]
				},
				{
					"name": "2.3 - Subscription (Recurring Payment)",
					"item": [
						{
							"name": "Step 2.3.1 - Create Recurring Price (Elements)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"let jsonData = pm.response.json();",
											"if(jsonData.id) {",
											"    pm.collectionVariables.set(\"price_id_elements_sub\", jsonData.id);",
											"    console.log(\"Recurring Price ID (Elements):\", jsonData.id);",
											"} else {",
											"    console.error(\"No recurring Price ID returned.\");",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "currency",
											"value": "usd",
											"type": "text"
										},
										{
											"key": "recurring[interval]",
											"value": "month",
											"type": "text"
										},
										{
											"key": "unit_amount",
											"value": "1200",
											"type": "text"
										},
										{
											"key": "product_data[name]",
											"value": "Elements Sub Product",
											"type": "text"
										},
										{
											"key": "nickname",
											"value": "Monthly Recurring (Elements)",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{stripe_base_url}}/v1/prices",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"prices"
									]
								},
								"description": "Creates a monthly recurring Price for subscription via an Elements-like approach."
							},
							"response": []
						},
						{
							"name": "Step 2.3.2 - Create Customer",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"let resp = pm.response.json();",
											"if(resp.id){",
											"    pm.collectionVariables.set(\"elements_sub_customer_id\", resp.id);",
											"    console.log(\"Created Customer:\", resp.id);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{stripe_base_url}}/v1/customers",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"customers"
									]
								},
								"description": "We'll create a Customer to attach the Payment Method, then create a Subscription. In real Elements flow, you'd collect card data client-side."
							},
							"response": []
						},
						{
							"name": "Step 2.3.3 - Create Payment Method & Attach to Customer",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"let r = pm.response.json();",
											"if(r.id){",
											"    pm.collectionVariables.set(\"pm_card_elements_sub\", r.id);",
											"    console.log(\"Payment Method:\", r.id);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "type",
											"value": "card",
											"type": "text"
										},
										{
											"key": "card[number]",
											"value": "4242424242424242",
											"type": "text"
										},
										{
											"key": "card[exp_month]",
											"value": "12",
											"type": "text"
										},
										{
											"key": "card[exp_year]",
											"value": "2030",
											"type": "text"
										},
										{
											"key": "card[cvc]",
											"value": "123",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{stripe_base_url}}/v1/payment_methods",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"payment_methods"
									]
								},
								"description": "Simulates creating a card Payment Method. We'll attach it to the Customer."
							},
							"response": []
						},
						{
							"name": "Step 2.3.4 - Attach Payment Method to Customer",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "customer",
											"value": "{{elements_sub_customer_id}}",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{stripe_base_url}}/v1/payment_methods/{{pm_card_elements_sub}}/attach",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"payment_methods",
										"{{pm_card_elements_sub}}",
										"attach"
									]
								},
								"description": "Attaches the card Payment Method to the new Customer."
							},
							"response": []
						},
						{
							"name": "Step 2.3.5 - Create Subscription",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{stripe_secret_key}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "customer",
											"value": "{{elements_sub_customer_id}}",
											"type": "text"
										},
										{
											"key": "items[0][price]",
											"value": "{{price_id_elements_sub}}",
											"type": "text"
										},
										{
											"key": "default_payment_method",
											"value": "{{pm_card_elements_sub}}",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{stripe_base_url}}/v1/subscriptions",
									"host": [
										"{{stripe_base_url}}"
									],
									"path": [
										"v1",
										"subscriptions"
									]
								},
								"description": "Creates a Subscription with the recurring Price, using the Payment Method attached to the Customer."
							},
							"response": []
						}
					]
				}
			]
		},
		{
			"name": "3. Common Endpoints (Retrieve, Refund, etc.)",
			"item": [
				{
					"name": "Step 3.1 - Retrieve Payment Intent (Generic)",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{stripe_secret_key}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{stripe_base_url}}/v1/payment_intents/{{payment_intent_id}}",
							"host": [
								"{{stripe_base_url}}"
							],
							"path": [
								"v1",
								"payment_intents",
								"{{payment_intent_id}}"
							]
						},
						"description": "Retrieve a Payment Intent by ID. Replace {{payment_intent_id}} with an actual ID from prior steps."
					},
					"response": []
				},
				{
					"name": "Step 3.2 - Refund (by Charge or Payment Intent)",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{stripe_secret_key}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "charge",
									"value": "{{charge_id}}",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{stripe_base_url}}/v1/refunds",
							"host": [
								"{{stripe_base_url}}"
							],
							"path": [
								"v1",
								"refunds"
							]
						},
						"description": "Pass either charge=<charge_id> or payment_intent=<pi_id> to create a refund. Default here uses charge."
					},
					"response": []
				},
				{
					"name": "Step 3.3 - Retrieve Subscription",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{stripe_secret_key}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{stripe_base_url}}/v1/subscriptions/{{subscription_id}}",
							"host": [
								"{{stripe_base_url}}"
							],
							"path": [
								"v1",
								"subscriptions",
								"{{subscription_id}}"
							]
						},
						"description": "Retrieve a Subscription by ID to check status or details."
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "stripe_base_url",
			"value": "https://api.stripe.com"
		},
		{
			"key": "stripe_secret_key",
			"value": "sk_test_51QjLHs04OJLZJ0l2JlQPxKGkWB0zk0SzCTWzSgTlrrfE73PdPudFk0k2GFGTInWof45YDteDkNn77Aif9H60j9TR00FsHwSH7l"
		},
		{
			"key": "webhook_url",
			"value": "https://webhook.site/e766614a-e523-4dae-9138-2c4948c3533e"
		},
		{
			"key": "webhook_endpoint_id",
			"value": ""
		},
		{
			"key": "success_url",
			"value": "https://example.com/success"
		},
		{
			"key": "cancel_url",
			"value": "https://example.com/cancel"
		},
		{
			"key": "random_name",
			"value": ""
		},
		{
			"key": "random_amount",
			"value": ""
		},
		{
			"key": "price_id_checkout_single",
			"value": ""
		},
		{
			"key": "checkout_session_id_normal",
			"value": ""
		},
		{
			"key": "price_id_checkout_preauth",
			"value": ""
		},
		{
			"key": "checkout_session_id_preauth",
			"value": ""
		},
		{
			"key": "pi_checkout_preauth_id",
			"value": "pi_3QksuB04OJLZJ0l208OyiVmN"
		},
		{
			"key": "price_id_checkout_sub",
			"value": ""
		},
		{
			"key": "checkout_session_id_sub",
			"value": ""
		},
		{
			"key": "price_id_elements_sub",
			"value": ""
		},
		{
			"key": "elements_sub_customer_id",
			"value": ""
		},
		{
			"key": "pm_card_elements_sub",
			"value": ""
		},
		{
			"key": "payment_intent_id",
			"value": ""
		},
		{
			"key": "charge_id",
			"value": ""
		},
		{
			"key": "subscription_id",
			"value": ""
		},
		{
			"key": "last_created_pi_id",
			"value": ""
		}
	]
}