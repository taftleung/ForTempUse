{
	"info": {
		"_postman_id": "ebc25055-b212-42ba-b7f0-bc96f9639eec",
		"name": "Geidea API Collection",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "12409896"
	},
	"item": [
		{
			"name": "Create Session",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"function generateRandomString(length) {\r",
							"    var chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\r",
							"    var result = '';\r",
							"    for (var i = length; i > 0; --i) result += chars[Math.floor(Math.random() * chars.length)];\r",
							"    return result;\r",
							"}\r",
							"\r",
							"function generateSignature(rawString, apiPassword) {\r",
							"    var signatureHmacSha256 = CryptoJS.HmacSHA256(rawString, apiPassword);\r",
							"    return CryptoJS.enc.Base64.stringify(signatureHmacSha256);\r",
							"}\r",
							"\r",
							"// Retrieve your stored variables\r",
							"const merchantPublicKey = 'd9fd2b48-16f6-4213-9d39-293139dc2795';\r",
							"const apiPassword = 'faab1120-bc38-4456-becf-c5d9a5e3c423';\r",
							"let currency = 'AED';\r",
							"\r",
							"// Generate dynamic data\r",
							"let randomReferenceId = 'POC-UAE-' + generateRandomString(6);\r",
							"let randomAmount = (Math.random() * 100).toFixed(2);\r",
							"let randomCofAgreementId = 'COF' + generateRandomString(6);\r",
							"\r",
							"// Get the current date and time\r",
							"const now = new Date();\r",
							"let timestamp = now.toLocaleString('en-US', {\r",
							"    year: 'numeric',\r",
							"    month: '2-digit',\r",
							"    day: '2-digit',\r",
							"    hour: '2-digit',\r",
							"    minute: '2-digit',\r",
							"    second: '2-digit',\r",
							"    hour12: true\r",
							"}).replace(',', '');\r",
							"\r",
							"// Prepare the string to be signed\r",
							"let rawString = merchantPublicKey + randomAmount + currency + randomReferenceId + timestamp;\r",
							"\r",
							"// Generate the signature\r",
							"let signature = generateSignature(rawString, apiPassword);\r",
							"\r",
							"// Update the environment variables\r",
							"pm.environment.set(\"randomReferenceId\", randomReferenceId);\r",
							"pm.environment.set(\"randomAmount\", randomAmount);\r",
							"pm.environment.set(\"randomCofAgreementId\", randomCofAgreementId);\r",
							"pm.environment.set(\"timestamp\", timestamp);\r",
							"pm.environment.set(\"signature\", signature);"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "basic",
					"basic": [
						{
							"key": "password",
							"value": "faab1120-bc38-4456-becf-c5d9a5e3c423",
							"type": "string"
						},
						{
							"key": "username",
							"value": "d9fd2b48-16f6-4213-9d39-293139dc2795",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"amount\": {{randomAmount}},\r\n  \"currency\": \"AED\",\r\n  \"language\": \"en\",\r\n  \"timestamp\": \"{{timestamp}}\",\r\n  \"merchantReferenceId\": \"{{randomReferenceId}}\",\r\n  \"callbackUrl\": \"https://webhook.site/a9f63bb4-988a-49d9-b532-d3a01bcb1b71\",\r\n  \"cardOnFile\": true,\r\n  \"paymentOperation\": \"Pay\",\r\n  \"cofAgreement\": {\r\n    \"id\": \"{{randomCofAgreementId}}\",\r\n    \"type\": \"UNSCHEDULED\"\r\n  },\r\n  \"order\": {\r\n    \"items\": [\r\n      {\r\n        \"merchantItemId\": \"product-1234\",\r\n        \"name\": \"Nike Shoes\",\r\n        \"description\": null,\r\n        \"categories\": \"other\",\r\n        \"count\": 2,\r\n        \"price\": 12.34\r\n      }\r\n    ],\r\n    \"description\": \"This is a description\"\r\n  },\r\n  \"signature\": \"{{signature}}\"\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "https://api-test.gd-azure-dev.net/payment-intent/api/v2/direct/session",
					"protocol": "https",
					"host": [
						"api-test",
						"gd-azure-dev",
						"net"
					],
					"path": [
						"payment-intent",
						"api",
						"v2",
						"direct",
						"session"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create Session (Tokenized Payment)",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"function generateRandomString(length) {\r",
							"    var chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\r",
							"    var result = '';\r",
							"    for (var i = length; i > 0; --i) result += chars[Math.floor(Math.random() * chars.length)];\r",
							"    return result;\r",
							"}\r",
							"\r",
							"function generateSignature(rawString, apiPassword) {\r",
							"    var signatureHmacSha256 = CryptoJS.HmacSHA256(rawString, apiPassword);\r",
							"    return CryptoJS.enc.Base64.stringify(signatureHmacSha256);\r",
							"}\r",
							"\r",
							"// Retrieve your stored variables\r",
							"const merchantPublicKey = 'd9fd2b48-16f6-4213-9d39-293139dc2795';\r",
							"const apiPassword = 'faab1120-bc38-4456-becf-c5d9a5e3c423';\r",
							"let currency = 'AED';\r",
							"\r",
							"// Generate dynamic data\r",
							"let randomReferenceId = 'POC-UAE-' + generateRandomString(6);\r",
							"let randomAmount = (Math.random() * 100).toFixed(2);\r",
							"\r",
							"// Get the current date and time\r",
							"const now = new Date();\r",
							"let timestamp = now.toLocaleString('en-US', {\r",
							"    year: 'numeric',\r",
							"    month: '2-digit',\r",
							"    day: '2-digit',\r",
							"    hour: '2-digit',\r",
							"    minute: '2-digit',\r",
							"    second: '2-digit',\r",
							"    hour12: true\r",
							"}).replace(',', '');\r",
							"\r",
							"// Prepare the string to be signed\r",
							"let rawString = merchantPublicKey + randomAmount + currency + randomReferenceId + timestamp;\r",
							"\r",
							"// Generate the signature\r",
							"let signature = generateSignature(rawString, apiPassword);\r",
							"\r",
							"// Update the environment variables\r",
							"pm.environment.set(\"randomReferenceId\", randomReferenceId);\r",
							"pm.environment.set(\"randomAmount\", randomAmount);\r",
							"pm.environment.set(\"timestamp\", timestamp);\r",
							"pm.environment.set(\"signature\", signature);"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "basic",
					"basic": [
						{
							"key": "password",
							"value": "faab1120-bc38-4456-becf-c5d9a5e3c423",
							"type": "string"
						},
						{
							"key": "username",
							"value": "d9fd2b48-16f6-4213-9d39-293139dc2795",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"amount\": {{randomAmount}},\r\n  \"currency\": \"AED\",\r\n  \"language\": \"en\",\r\n  \"timestamp\": \"{{timestamp}}\",\r\n  \"merchantReferenceId\": \"{{randomReferenceId}}\",\r\n  \"callbackUrl\": \"https://webhook.site/a9f63bb4-988a-49d9-b532-d3a01bcb1b71\",\r\n  \"paymentOperation\": \"Pay\",\r\n  \"tokenId\": \"2a6a6dcb-458b-46a2-094f-08dc3d100b9e\",\r\n  \"order\": {\r\n    \"items\": [\r\n      {\r\n        \"merchantItemId\": \"product-1234\",\r\n        \"name\": \"Nike Shoes\",\r\n        \"description\": null,\r\n        \"categories\": \"other\",\r\n        \"count\": 2,\r\n        \"price\": 12.34\r\n      }\r\n    ],\r\n    \"description\": \"This is a description\"\r\n  },\r\n  \"signature\": \"{{signature}}\"\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "https://api-test.gd-azure-dev.net/payment-intent/api/v2/direct/session",
					"protocol": "https",
					"host": [
						"api-test",
						"gd-azure-dev",
						"net"
					],
					"path": [
						"payment-intent",
						"api",
						"v2",
						"direct",
						"session"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create Recurring Payment (Token)",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"function generateRandomString(length) {\r",
							"    var chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\r",
							"    var result = '';\r",
							"    for (var i = length; i > 0; --i) result += chars[Math.floor(Math.random() * chars.length)];\r",
							"    return result;\r",
							"}\r",
							"\r",
							"let randomReferenceId = 'POC-UAE-' + generateRandomString(6);\r",
							"pm.environment.set(\"randomReferenceId\", randomReferenceId);\r",
							"\r",
							"let randomAmount = (Math.random() * 100).toFixed(2);\r",
							"pm.environment.set(\"randomAmount\", randomAmount);\r",
							"\r",
							"let randomCofAgreementId = 'TEST-COF-' + generateRandomString(6);\r",
							"pm.environment.set(\"randomCofAgreementId\", randomCofAgreementId);"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "basic",
					"basic": [
						{
							"key": "password",
							"value": "faab1120-bc38-4456-becf-c5d9a5e3c423",
							"type": "string"
						},
						{
							"key": "username",
							"value": "d9fd2b48-16f6-4213-9d39-293139dc2795",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n\t\"amount\": {{randomAmount}},\r\n\t\"payWithToken\": true,\r\n\t\"currency\": \"AED\",\r\n\t\"tokenId\": \"20763c3f-2012-4c85-0951-08dc3d100b9e\",\r\n\t\"isCreateCustomerEnabled\": false,\r\n\t\"isSetPaymentMethodEnabled\": false,\r\n\t\"paymentOperation\": \"pay\",\r\n\t\"initiatedBy\": \"Merchant\",\r\n\t\"agreementId\": \"cof1223423\",\r\n\t\"agreementType\": \"Unscheduled\"\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "https://api-test.gd-azure-dev.net/pgw/api/v1/direct/pay/token",
					"protocol": "https",
					"host": [
						"api-test",
						"gd-azure-dev",
						"net"
					],
					"path": [
						"pgw",
						"api",
						"v1",
						"direct",
						"pay",
						"token"
					]
				}
			},
			"response": []
		},
		{
			"name": "Fetch Order / Transaction by Merchant Reference ID",
			"request": {
				"auth": {
					"type": "basic",
					"basic": [
						{
							"key": "password",
							"value": "faab1120-bc38-4456-becf-c5d9a5e3c423",
							"type": "string"
						},
						{
							"key": "username",
							"value": "d9fd2b48-16f6-4213-9d39-293139dc2795",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "https://api-test.gd-azure-dev.net/pgw/api/v1/direct/order?MerchantReferenceId=POC-UAE-7unpWl",
					"protocol": "https",
					"host": [
						"api-test",
						"gd-azure-dev",
						"net"
					],
					"path": [
						"pgw",
						"api",
						"v1",
						"direct",
						"order"
					],
					"query": [
						{
							"key": "MerchantReferenceId",
							"value": "POC-UAE-7unpWl"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Void Payment",
			"request": {
				"auth": {
					"type": "basic",
					"basic": [
						{
							"key": "password",
							"value": "faab1120-bc38-4456-becf-c5d9a5e3c423",
							"type": "string"
						},
						{
							"key": "username",
							"value": "d9fd2b48-16f6-4213-9d39-293139dc2795",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"OrderId\": \"192d7d0f-f1c4-426d-dd73-08dc3bde4c14\",\r\n  \"callbackUrl\": \"https://webhook.site/6fee521c-92b2-47dc-94a9-2cf6cb465852\"\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "https://api-test.gd-azure-dev.net/pgw/api/v3/direct/void",
					"protocol": "https",
					"host": [
						"api-test",
						"gd-azure-dev",
						"net"
					],
					"path": [
						"pgw",
						"api",
						"v3",
						"direct",
						"void"
					]
				}
			},
			"response": []
		},
		{
			"name": "Refund",
			"request": {
				"auth": {
					"type": "basic",
					"basic": [
						{
							"key": "password",
							"value": "faab1120-bc38-4456-becf-c5d9a5e3c423",
							"type": "string"
						},
						{
							"key": "username",
							"value": "d9fd2b48-16f6-4213-9d39-293139dc2795",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"orderId\": \"192d7d0f-f1c4-426d-dd73-08dc3bde4c14\",\r\n  \"refundAmount\": 10.00\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "https://api-test.gd-azure-dev.net/pgw/api/v1/direct/refund",
					"protocol": "https",
					"host": [
						"api-test",
						"gd-azure-dev",
						"net"
					],
					"path": [
						"pgw",
						"api",
						"v1",
						"direct",
						"refund"
					]
				}
			},
			"response": []
		}
	]
}